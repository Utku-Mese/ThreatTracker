<head>
    <style>
        body {
            margin: 0;
        }
    </style>
    <script src="//unpkg.com/d3-dsv"></script>
    <script src="//unpkg.com/index-array-by"></script>
    <script src="//unpkg.com/globe.gl"></script>
</head>
<body>
    <div id="globeViz"></div>
    
    <script>
        /* const jsonData = {
            "Birds": [
                {
                    "Id": 1,
                    "Name": "Leylek",
                    "Linecolor": [
                        "#000055",
                        "#AAAAff"
                    ],
                    "startPoint": [
                        41.0082,
                        28.9784
                    ],
                    "endPoint": [
                        37.7749,
                        -122.4194
                    ],
                    "Card": {
                        "image": "https://raw.githubusercontent.com/Utku-Mese/LifeSync/main/assets/images/area1.png",
                        "title": "Leylek",
                        "description": "Leylekler, genellikle sıcak iklimlerde yaşarlar. Leyleklerin en bilinen özelliği, yuvalarını yüksek yerlere yapmalarıdır."
                    }
                },

                {
                    "Id": 2,
                    "Name": "Kartal",
                    "Linecolor": [
                        "#550000",
                        "#FFAAAA"
                    ],
                    "startPoint": [
                        34.0522,
                        -118.2437
                    ],
                    "endPoint": [
                        40.7128,
                        -74.0060
                    ],
                    "Card": {
                        "image": "https://raw.githubusercontent.com/Utku-Mese/LifeSync/main/assets/images/area2.png",
                        "title": "Kartal",
                        "description": "Kartallar, genellikle yüksek yerlerde yaşarlar. Kartalların en bilinen özelliği, avlarını yüksek yerlerden avlamalarıdır."
                    }
                },
                {
                    "Id": 3,
                    "Name": "Baykuş",
                    "Linecolor": [
                        "#005500",
                        "#AAFFAA"
                    ],
                    "startPoint": [
                        40.7128,
                        -74.0060
                    ],
                    "endPoint": [
                        41.0082,
                        28.9784
                    ],
                    "Card": {
                        "image": "https://raw.githubusercontent.com/Utku-Mese/LifeSync/main/assets/images/area3.png",
                        "title": "Baykuş",
                        "description": "Baykuşlar, genellikle gece avlanan kuşlardır."
                    }
                }
            ]
        } */

        const jsonData = fetch('https://raw.githubusercontent.com/Utku-Mese/LifeSync/main/assets/data/birds.json')
            .then(res => res.json())
            .then(data => data);

        const birdsData = jsonData.Birds.map(bird => ({
            name: bird.Name,
            lineColor: bird.Linecolor,
            startPoint: { lat: bird.startPoint[0], lng: bird.startPoint[1] },
            endPoint: { lat: bird.endPoint[0], lng: bird.endPoint[1] },
            card: bird.Card
        }));

        const myGlobe = Globe()
            (document.getElementById('globeViz'))

            .globeImageUrl('//unpkg.com/three-globe/example/img/earth-night.jpg')
            .pointOfView({ lat: 39.6, lng: -98.5, altitude: 2 }) // aim at continental US centroid

            .arcLabel(d => `${d.name}: ${d.card.description}`)
            .arcStartLat(d => +d.startPoint.lat)
            .arcStartLng(d => +d.startPoint.lng)
            .arcEndLat(d => +d.endPoint.lat)
            .arcEndLng(d => +d.endPoint.lng)
            .arcDashLength(0.75)
            .arcDashGap(1)
            .arcDashInitialGap(() => Math.random())
            .arcDashAnimateTime(2000)
            .arcColor(d => d.lineColor)
            .arcsTransitionDuration(0)

            .pointColor(() => 'orange')
            .pointAltitude(0)
            .pointRadius(0.02)
            .pointsMerge(true);

        // load data
        myGlobe.arcsData(birdsData);
    </script>
</body>